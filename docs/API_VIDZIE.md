# VIDZIE API Documentation
**AI-Powered Video Generation with D-ID**

Version: 1.0.0
Last Updated: October 13, 2025
Base URL: `http://localhost:5000/api/vidzie`

---

## Table of Contents

1. [Introduction](#introduction)
2. [Authentication](#authentication)
3. [API Endpoints](#api-endpoints)
4. [Data Models](#data-models)
5. [Error Handling](#error-handling)
6. [Rate Limits](#rate-limits)
7. [Code Examples](#code-examples)
8. [Integration Guide](#integration-guide)

---

## Introduction

VIDZIE is Z2B's AI-powered video generation system that creates talking avatar videos using D-ID technology. This API allows you to:

- Generate talking avatar videos from images and scripts
- Track video generation progress
- Manage video library
- Share and download videos
- Track usage statistics

### Key Features

✅ **AI Talking Avatars** - Transform static images into speaking videos
✅ **Multiple Voice Options** - Choose from various voices and languages
✅ **Real-time Progress** - Track generation status
✅ **HD Quality** - Support for SD, HD, and Full HD
✅ **Usage Tracking** - Monitor generations, views, and downloads
✅ **Sharing** - Generate shareable links for videos

---

## Authentication

All VIDZIE API endpoints require authentication via JWT token.

### Headers Required

```
Authorization: Bearer YOUR_JWT_TOKEN
Content-Type: application/json
```

### Getting Auth Token

```javascript
// Login to get token
const response = await fetch('http://localhost:5000/api/auth/login', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
        email: 'user@example.com',
        password: 'password123'
    })
});

const { token } = await response.json();
localStorage.setItem('authToken', token);
```

---

## API Endpoints

### 1. Generate Video

**POST** `/api/vidzie/generate`

Create a new talking avatar video.

#### Request Body

```json
{
    "videoName": "My First Video",
    "description": "A welcome message",
    "videoType": "avatar",
    "purpose": "standalone",
    "sourceImage": "https://example.com/avatar.jpg",
    "script": "Hello! Welcome to my video. This is generated by VIDZIE.",
    "voiceId": "en-US-JennyNeural",
    "voiceGender": "female",
    "voiceStyle": "friendly",
    "settings": {
        "resolution": "HD",
        "background": "#FFFFFF",
        "fps": 30
    }
}
```

#### Field Descriptions

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `videoName` | string | No | Name for the video (default: "Video-{timestamp}") |
| `description` | string | No | Description (max 500 chars) |
| `videoType` | string | Yes | Type: avatar, presentation, tutorial, testimonial, marketing, coaching |
| `purpose` | string | Yes | Purpose: glowie-app, coach-manlaw, standalone, zyra, marketplace |
| `sourceImage` | string | Yes | URL or base64 of avatar image |
| `script` | string | Yes | Text to speak (10-5000 chars) |
| `voiceId` | string | No | Voice ID (default: en-US-JennyNeural) |
| `voiceGender` | string | No | Gender: male, female, neutral |
| `voiceStyle` | string | No | Style: friendly, professional, casual |
| `settings.resolution` | string | No | SD, HD, or FHD (default: HD) |
| `settings.background` | string | No | Background color hex (default: #FFFFFF) |
| `settings.fps` | number | No | Frame rate (default: 30) |

#### Response

```json
{
    "success": true,
    "message": "Video generation started!",
    "data": {
        "videoId": "507f1f77bcf86cd799439011",
        "videoName": "My First Video",
        "videoType": "avatar",
        "purpose": "standalone",
        "status": "processing",
        "talkId": "tlk_abc123",
        "createdAt": "2025-10-13T10:00:00.000Z",
        "remainingGenerations": 9
    }
}
```

#### Error Responses

```json
{
    "success": false,
    "message": "Script must be at least 10 characters long"
}
```

```json
{
    "success": false,
    "message": "Monthly generation limit reached. Limit resets on 11/1/2025.",
    "monthlyLimit": 10,
    "monthlyUsage": 10
}
```

---

### 2. Get Video Details

**GET** `/api/vidzie/video/:videoId`

Retrieve complete details for a specific video.

#### Response

```json
{
    "success": true,
    "data": {
        "_id": "507f1f77bcf86cd799439011",
        "videoName": "My First Video",
        "description": "A welcome message",
        "videoType": "avatar",
        "purpose": "standalone",
        "did": {
            "sourceImage": "https://example.com/avatar.jpg",
            "script": "Hello! Welcome to my video...",
            "voice": {
                "voiceId": "en-US-JennyNeural",
                "language": "en-US",
                "gender": "female",
                "style": "friendly"
            },
            "talkId": "tlk_abc123",
            "videoUrl": "https://d-id.com/video.mp4",
            "thumbnailUrl": "https://d-id.com/thumb.jpg",
            "settings": {
                "background": "#FFFFFF",
                "resolution": "HD",
                "duration": 15,
                "fps": 30
            }
        },
        "status": "completed",
        "progress": 100,
        "views": 5,
        "downloads": 2,
        "shares": 1,
        "isPublic": false,
        "processingTime": 12500,
        "createdAt": "2025-10-13T10:00:00.000Z",
        "completedAt": "2025-10-13T10:00:12.500Z"
    }
}
```

---

### 3. Check Video Status

**GET** `/api/vidzie/video/:videoId/status`

Check the generation status of a video. Automatically updates video status if still processing.

#### Response

```json
{
    "success": true,
    "data": {
        "videoId": "507f1f77bcf86cd799439011",
        "status": "processing",
        "progress": 45,
        "videoUrl": null,
        "errorMessage": null,
        "processingTime": 5000,
        "completedAt": null
    }
}
```

**Status Values:**
- `queued` - Video is in queue
- `processing` - Video is being generated
- `completed` - Video is ready
- `failed` - Generation failed
- `deleted` - Video was deleted

---

### 4. Get User's Videos

**GET** `/api/vidzie/videos`

Retrieve all videos for the authenticated user with pagination and filtering.

#### Query Parameters

| Parameter | Type | Description |
|-----------|------|-------------|
| `page` | number | Page number (default: 1) |
| `limit` | number | Results per page (default: 10) |
| `videoType` | string | Filter by video type |
| `purpose` | string | Filter by purpose |
| `status` | string | Filter by status (default: all) |
| `sortBy` | string | Sort field (default: createdAt) |
| `order` | string | Sort order: asc or desc (default: desc) |

#### Example Request

```
GET /api/vidzie/videos?page=1&limit=10&videoType=avatar&status=completed
```

#### Response

```json
{
    "success": true,
    "data": [
        {
            "_id": "507f1f77bcf86cd799439011",
            "videoName": "My First Video",
            "videoType": "avatar",
            "status": "completed",
            "did": {
                "videoUrl": "https://d-id.com/video.mp4",
                "thumbnailUrl": "https://d-id.com/thumb.jpg"
            },
            "views": 5,
            "downloads": 2,
            "createdAt": "2025-10-13T10:00:00.000Z"
        }
    ],
    "pagination": {
        "total": 15,
        "page": 1,
        "pages": 2,
        "limit": 10
    }
}
```

---

### 5. Update Video

**PUT** `/api/vidzie/video/:videoId`

Update video metadata (name, rating, visibility, etc.).

#### Request Body

```json
{
    "videoName": "Updated Video Name",
    "userRating": 5,
    "feedback": "Great video!",
    "isPublic": true,
    "tags": ["marketing", "product-demo", "2025"]
}
```

#### Response

```json
{
    "success": true,
    "message": "Video updated successfully",
    "data": {
        "_id": "507f1f77bcf86cd799439011",
        "videoName": "Updated Video Name",
        "userRating": 5,
        "isPublic": true,
        "tags": ["marketing", "product-demo", "2025"]
    }
}
```

---

### 6. Delete Video

**DELETE** `/api/vidzie/video/:videoId`

Soft delete a video (changes status to 'deleted').

#### Response

```json
{
    "success": true,
    "message": "Video deleted successfully"
}
```

---

### 7. Generate Share Link

**POST** `/api/vidzie/video/:videoId/share`

Generate a shareable link for a video. Automatically makes video public.

#### Response

```json
{
    "success": true,
    "data": {
        "shareLink": "vidzie-a3b2c1d4e5f6",
        "shareUrl": "http://localhost:5000/shared/vidzie-a3b2c1d4e5f6"
    }
}
```

---

### 8. Track Download

**POST** `/api/vidzie/video/:videoId/download`

Track when a video is downloaded.

#### Response

```json
{
    "success": true,
    "message": "Download tracked",
    "data": {
        "downloads": 3
    }
}
```

---

### 9. Get Available Voices

**GET** `/api/vidzie/voices`

Get list of available voices for video generation.

#### Query Parameters

| Parameter | Type | Description |
|-----------|------|-------------|
| `provider` | string | Voice provider: microsoft, amazon, google (default: microsoft) |
| `useCase` | string | Use case: coaching, marketing, professional, casual |
| `fetchAll` | boolean | Fetch all voices from D-ID API (default: false) |

#### Response

```json
{
    "success": true,
    "data": {
        "recommended": [
            {
                "id": "en-US-JennyNeural",
                "name": "Jenny (US English, Female)",
                "gender": "female",
                "style": "friendly"
            },
            {
                "id": "en-US-GuyNeural",
                "name": "Guy (US English, Male)",
                "gender": "male",
                "style": "professional"
            }
        ],
        "all": null,
        "provider": "microsoft",
        "useCase": "professional"
    }
}
```

---

### 10. Get User Statistics

**GET** `/api/vidzie/stats`

Get video generation statistics for the authenticated user.

#### Response

```json
{
    "success": true,
    "data": {
        "totalVideos": 15,
        "totalViews": 150,
        "totalDownloads": 45,
        "avgProcessingTime": 12500,
        "avgFileSize": 5242880,
        "avgRating": 4.5,
        "monthlyLimit": 10,
        "monthlyUsage": 7,
        "remainingGenerations": 3
    }
}
```

---

### 11. Get Popular Videos

**GET** `/api/vidzie/popular`

Get popular public videos across the platform.

#### Query Parameters

| Parameter | Type | Description |
|-----------|------|-------------|
| `limit` | number | Number of videos to return (default: 10) |

#### Response

```json
{
    "success": true,
    "data": [
        {
            "_id": "507f1f77bcf86cd799439011",
            "videoName": "Popular Video",
            "videoType": "marketing",
            "views": 1500,
            "downloads": 250,
            "did": {
                "videoUrl": "https://d-id.com/video.mp4"
            },
            "userId": {
                "name": "John Doe",
                "email": "john@example.com"
            }
        }
    ]
}
```

---

### 12. Check D-ID Credits

**GET** `/api/vidzie/credits`

Check remaining D-ID API credits.

#### Response

```json
{
    "success": true,
    "data": {
        "credits": 1250
    }
}
```

---

### 13. Poll for Completion

**POST** `/api/vidzie/video/:videoId/poll`

Long-running request that polls D-ID API until video is completed.

#### Request Body

```json
{
    "maxAttempts": 30,
    "interval": 3000
}
```

#### Response (when completed)

```json
{
    "success": true,
    "message": "Video completed successfully",
    "data": {
        "videoId": "507f1f77bcf86cd799439011",
        "videoUrl": "https://d-id.com/video.mp4",
        "duration": 15,
        "attempts": 12
    }
}
```

---

## Data Models

### VideoGeneration Model

```javascript
{
    userId: ObjectId,
    videoName: String,
    description: String (max 500),
    videoType: enum ['avatar', 'presentation', 'tutorial', 'testimonial', 'marketing', 'coaching', 'other'],
    purpose: enum ['glowie-app', 'coach-manlaw', 'standalone', 'zyra', 'marketplace'],
    did: {
        sourceImage: String (URL or base64),
        script: String (max 5000),
        voice: {
            voiceId: String,
            language: String,
            gender: enum ['male', 'female', 'neutral'],
            style: String
        },
        talkId: String,
        videoUrl: String,
        thumbnailUrl: String,
        settings: {
            background: String (hex color),
            resolution: enum ['SD', 'HD', 'FHD'],
            duration: Number (seconds),
            fps: Number
        }
    },
    status: enum ['queued', 'processing', 'completed', 'failed', 'deleted'],
    progress: Number (0-100),
    errorMessage: String,
    processingTime: Number (milliseconds),
    queuedAt: Date,
    startedAt: Date,
    completedAt: Date,
    views: Number,
    downloads: Number,
    shares: Number,
    isPublic: Boolean,
    shareLink: String,
    userRating: Number (1-5),
    feedback: String (max 500),
    tags: [String],
    relatedAppId: ObjectId,
    relatedSessionId: ObjectId,
    fileSize: Number (bytes),
    format: String,
    version: Number,
    createdAt: Date,
    updatedAt: Date
}
```

---

## Error Handling

### Error Response Format

```json
{
    "success": false,
    "message": "Error description",
    "error": "Detailed error message"
}
```

### Common Error Codes

| Status Code | Description |
|-------------|-------------|
| 400 | Bad Request - Invalid input |
| 401 | Unauthorized - Invalid or missing token |
| 403 | Forbidden - Access denied |
| 404 | Not Found - Resource doesn't exist |
| 429 | Too Many Requests - Rate limit exceeded |
| 500 | Internal Server Error |

### Example Error Responses

**Invalid Script Length:**
```json
{
    "success": false,
    "message": "Script must be at least 10 characters long"
}
```

**Monthly Limit Reached:**
```json
{
    "success": false,
    "message": "Monthly generation limit reached. Limit resets on 11/1/2025.",
    "monthlyLimit": 10,
    "monthlyUsage": 10
}
```

**D-ID API Error:**
```json
{
    "success": false,
    "message": "Failed to generate video",
    "error": "D-ID API error: Insufficient credits"
}
```

---

## Rate Limits

### Generation Limits

**Free Tier:**
- 10 videos per month
- Resets on the 1st of each month
- HD quality maximum

**Pro Tier:**
- 100 videos per month
- Full HD quality available

**Enterprise:**
- Unlimited videos
- Priority processing

### API Rate Limits

- **Video Generation:** 1 request per 5 seconds
- **Status Checks:** 10 requests per second
- **List/Get Operations:** 100 requests per minute

---

## Code Examples

### JavaScript/Node.js

#### Generate Video

```javascript
async function generateVideo() {
    const authToken = localStorage.getItem('authToken');

    const response = await fetch('http://localhost:5000/api/vidzie/generate', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${authToken}`
        },
        body: JSON.stringify({
            videoName: 'My Video',
            videoType: 'avatar',
            purpose: 'standalone',
            sourceImage: 'https://example.com/avatar.jpg',
            script: 'Hello! This is my video generated with VIDZIE.',
            voiceId: 'en-US-JennyNeural',
            settings: {
                resolution: 'HD'
            }
        })
    });

    const data = await response.json();

    if (data.success) {
        console.log('Video ID:', data.data.videoId);
        return data.data.videoId;
    } else {
        console.error('Error:', data.message);
    }
}
```

#### Poll Video Status

```javascript
async function pollVideoStatus(videoId) {
    const authToken = localStorage.getItem('authToken');

    const checkStatus = async () => {
        const response = await fetch(
            `http://localhost:5000/api/vidzie/video/${videoId}/status`,
            {
                headers: {
                    'Authorization': `Bearer ${authToken}`
                }
            }
        );

        const data = await response.json();

        if (data.success) {
            console.log('Status:', data.data.status);
            console.log('Progress:', data.data.progress + '%');

            if (data.data.status === 'completed') {
                console.log('Video URL:', data.data.videoUrl);
                return data.data.videoUrl;
            }

            if (data.data.status === 'failed') {
                console.error('Generation failed');
                return null;
            }

            // Continue polling
            setTimeout(checkStatus, 5000);
        }
    };

    checkStatus();
}
```

#### Get User Videos

```javascript
async function getUserVideos(page = 1) {
    const authToken = localStorage.getItem('authToken');

    const response = await fetch(
        `http://localhost:5000/api/vidzie/videos?page=${page}&limit=10&status=completed`,
        {
            headers: {
                'Authorization': `Bearer ${authToken}`
            }
        }
    );

    const data = await response.json();

    if (data.success) {
        console.log('Videos:', data.data);
        console.log('Total:', data.pagination.total);
        return data.data;
    }
}
```

### Python

```python
import requests
import time

API_URL = 'http://localhost:5000/api/vidzie'

def generate_video(auth_token, script, image_url):
    headers = {
        'Authorization': f'Bearer {auth_token}',
        'Content-Type': 'application/json'
    }

    payload = {
        'videoName': 'Python Generated Video',
        'videoType': 'avatar',
        'purpose': 'standalone',
        'sourceImage': image_url,
        'script': script,
        'voiceId': 'en-US-JennyNeural',
        'settings': {
            'resolution': 'HD'
        }
    }

    response = requests.post(f'{API_URL}/generate', json=payload, headers=headers)
    data = response.json()

    if data['success']:
        return data['data']['videoId']
    else:
        raise Exception(data['message'])

def poll_video_status(auth_token, video_id):
    headers = {
        'Authorization': f'Bearer {auth_token}'
    }

    while True:
        response = requests.get(f'{API_URL}/video/{video_id}/status', headers=headers)
        data = response.json()

        if data['success']:
            status = data['data']['status']
            progress = data['data']['progress']

            print(f'Status: {status}, Progress: {progress}%')

            if status == 'completed':
                return data['data']['videoUrl']

            if status == 'failed':
                raise Exception('Video generation failed')

            time.sleep(5)

# Usage
auth_token = 'your_auth_token_here'
video_id = generate_video(
    auth_token,
    'Hello from Python!',
    'https://example.com/avatar.jpg'
)
video_url = poll_video_status(auth_token, video_id)
print(f'Video ready: {video_url}')
```

### cURL

```bash
# Generate video
curl -X POST http://localhost:5000/api/vidzie/generate \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -d '{
    "videoName": "Test Video",
    "videoType": "avatar",
    "purpose": "standalone",
    "sourceImage": "https://example.com/avatar.jpg",
    "script": "Hello from cURL!",
    "voiceId": "en-US-JennyNeural"
  }'

# Check status
curl -X GET http://localhost:5000/api/vidzie/video/VIDEO_ID/status \
  -H "Authorization: Bearer YOUR_TOKEN"

# Get user videos
curl -X GET "http://localhost:5000/api/vidzie/videos?page=1&limit=10" \
  -H "Authorization: Bearer YOUR_TOKEN"
```

---

## Integration Guide

### Step 1: Authentication

First, authenticate the user and store the JWT token:

```javascript
const login = async (email, password) => {
    const response = await fetch('http://localhost:5000/api/auth/login', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ email, password })
    });

    const { token } = await response.json();
    localStorage.setItem('authToken', token);
    return token;
};
```

### Step 2: Prepare Video Data

```javascript
const videoData = {
    videoName: 'Welcome Video',
    videoType: 'avatar',
    purpose: 'standalone',
    sourceImage: 'https://example.com/avatar.jpg',
    script: 'Welcome to our platform! We are excited to have you here.',
    voiceId: 'en-US-JennyNeural',
    settings: {
        resolution: 'HD'
    }
};
```

### Step 3: Generate Video

```javascript
const videoId = await generateVideo(videoData);
```

### Step 4: Poll for Completion

```javascript
const videoUrl = await pollVideoStatus(videoId);
```

### Step 5: Display Video

```javascript
const videoElement = document.getElementById('video-player');
videoElement.src = videoUrl;
```

### Complete Integration Example

```html
<!DOCTYPE html>
<html>
<body>
    <input type="file" id="imageUpload" accept="image/*">
    <textarea id="script" placeholder="Enter your script..."></textarea>
    <button onclick="createVideo()">Generate Video</button>

    <div id="status"></div>
    <video id="videoPlayer" controls style="display:none;"></video>

    <script>
        async function createVideo() {
            const authToken = localStorage.getItem('authToken');
            const file = document.getElementById('imageUpload').files[0];
            const script = document.getElementById('script').value;

            // Convert image to base64
            const reader = new FileReader();
            reader.onload = async (e) => {
                const sourceImage = e.target.result;

                // Generate video
                const response = await fetch('http://localhost:5000/api/vidzie/generate', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`
                    },
                    body: JSON.stringify({
                        videoType: 'avatar',
                        purpose: 'standalone',
                        sourceImage,
                        script,
                        voiceId: 'en-US-JennyNeural'
                    })
                });

                const data = await response.json();

                if (data.success) {
                    document.getElementById('status').textContent = 'Generating...';
                    pollStatus(data.data.videoId);
                }
            };

            reader.readAsDataURL(file);
        }

        async function pollStatus(videoId) {
            const authToken = localStorage.getItem('authToken');

            const check = async () => {
                const response = await fetch(
                    `http://localhost:5000/api/vidzie/video/${videoId}/status`,
                    {
                        headers: {
                            'Authorization': `Bearer ${authToken}`
                        }
                    }
                );

                const data = await response.json();

                if (data.data.status === 'completed') {
                    document.getElementById('status').textContent = 'Ready!';
                    document.getElementById('videoPlayer').src = data.data.videoUrl;
                    document.getElementById('videoPlayer').style.display = 'block';
                } else if (data.data.status === 'failed') {
                    document.getElementById('status').textContent = 'Failed';
                } else {
                    document.getElementById('status').textContent =
                        `Processing... ${data.data.progress}%`;
                    setTimeout(check, 5000);
                }
            };

            check();
        }
    </script>
</body>
</html>
```

---

## Best Practices

### 1. Image Requirements

- **Format:** JPG, PNG
- **Resolution:** Minimum 512x512px
- **Size:** Maximum 5MB
- **Face:** Clear, front-facing, good lighting

### 2. Script Writing

- Keep scripts under 3000 characters for best results
- Use natural language and punctuation
- Avoid special characters or code
- Use SSML tags for advanced control (optional)

### 3. Voice Selection

- Choose voice based on content type
- Match voice gender to avatar image
- Test different voices for best results

### 4. Error Handling

Always implement proper error handling:

```javascript
try {
    const videoId = await generateVideo(data);
    const videoUrl = await pollVideoStatus(videoId);
    displayVideo(videoUrl);
} catch (error) {
    console.error('Video generation error:', error);
    showErrorMessage(error.message);
}
```

### 5. Progress Feedback

Provide real-time feedback to users:

```javascript
const updateProgress = (progress) => {
    const progressBar = document.getElementById('progress');
    progressBar.style.width = progress + '%';
    progressBar.textContent = progress + '%';
};
```

---

## Support

### Admin Setup

1. Get D-ID API key from https://studio.d-id.com
2. Add to `.env` file:
   ```
   DID_API_KEY=your-d-id-api-key-here
   ```
3. Restart server

### Troubleshooting

**Video generation fails:**
- Check D-ID API key is valid
- Verify image URL is accessible
- Ensure script is within character limits

**Status polling timeout:**
- Increase polling timeout
- Check D-ID service status
- Verify network connectivity

**Video not displaying:**
- Check CORS settings
- Verify video URL is accessible
- Test video URL directly in browser

---

## Changelog

### Version 1.0.0 (October 13, 2025)
- Initial release
- D-ID integration complete
- All endpoints implemented
- Documentation complete

---

**Generated with VIDZIE - AI Video Builder**
**Part of the Zero to Billionaires (Z2B) Platform**

For more information: https://github.com/z2b-platform
